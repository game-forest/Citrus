<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>ПРИКРЕПЛЕНИЕ РЕСУРСОВ К ПРИЛОЖЕНИЮ | Citrus Engine </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="ПРИКРЕПЛЕНИЕ РЕСУРСОВ К ПРИЛОЖЕНИЮ | Citrus Engine ">
      
      <link rel="icon" href="../../images/favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../images/logo.png" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="прикрепление-ресурсов-к-приложению">ПРИКРЕПЛЕНИЕ РЕСУРСОВ К ПРИЛОЖЕНИЮ</h1>

<p>В Xamarin.Android ресурсы приложения могут быть представлены 3 способами: AndroidAssets, AndroidResources и EmbeddedResources.
Первые 2 способа нативны для платформы андроид, третий способ -- универсальный для любых .NET приложений.
Отличие AndroidAssets от AndroidResources в том, что первый способ предполагает хранение сырых ресурсов, в то время как в AndroidResources могут включаться файлы только определенных типов и для них препроцессор генерит код для быстрого доступа. Оба этих способа нам не подходят так-как Data.Android нельзя положить в AndroidResources (препроцессор не знает что это), а если положить этот файл в AndroidAssets, то Xamarin.Android предоставляет только потоковый доступ к файлу (нельзя читать его с произвольной позиции).
Ресурсы мы будем прикреплять методом EmbeddedResources. Однако, если положить Data.Android в главную сборку, то не работает оптимизация Fast assembly deployment (главная сборка игры будет включать XXX мегабайтный файл ресурсов и заливаться на устройство каждый раз при запуске приложения). Поэтому рекомендуется создать одельную сборку для ресурсов (скажем: Assets.Anroid) и в нее положить Data.Android. В результате ресурсы будут копироваться на устройство только после их пересборки.
Резюме:
Ресурсы нужно хранить в отдельной сборке (Assets.Android) методом EmbeddedResources.</p>
<h1 id="поддержка-сжатых-текстур">ПОДДЕРЖКА СЖАТЫХ ТЕКСТУР</h1>
<p>Как хорошо известно, Андроид поддерживает зоопарк стандартов сжатых текстур. Чтобы не создавать отдельный дистрибутив под каждый формат, Цитрус использует единственный поддерживаемый всеми формат - ETC1. К сожалению данный формат не поддерживает альфа-канал.
Для решения этой проблемы существует несколько способов, описанных в статье:
<a href="http://malideveloper.arm.com/develop-for-mali/sample-code/etcv1-texture-compression-and-alpha-channels/">http://malideveloper.arm.com/develop-for-mali/sample-code/etcv1-texture-compression-and-alpha-channels/</a>
В цитрусе мы реализуем способ №2 - для каждой текстуры с альфа каналом создается отдельная текстура с маской.</p>
<h1 id="как-использовать-нативные-библиотеки">КАК ИСПОЛЬЗОВАТЬ НАТИВНЫЕ БИБЛИОТЕКИ</h1>
<p>Руководство здесь: developer.xamarin.com/guides/android/advanced_topics/using_native_libraries/
Но вот кое-что авторы не доработали: если какая-либо сборка содержит нативную библиотеку, то на эту сборку обязана ссылаться главная сборка приложения. В противном случае вы будете долго разбираться: почему же моя нативная библиотека не попала в .apk? В частности главная сборка игры ОБЯЗАНА иметь ссылку на Lemon.Android.dll
Если нативная библиотека использует JNI, то для того чтобы она была проинициализирована нужно вызвать: Java.Lang.JavaSystem.LoadLibrary(&quot;library&quot;);</p>
<h1 id="как-пересобирать-openal">КАК ПЕРЕСОБИРАТЬ OPENAL</h1>
<p>OpenAL для андроида скачивается с <a href="http://repo.or.cz/w/openal-soft/android.git">http://repo.or.cz/w/openal-soft/android.git</a>
Чтобы OpenTK не падал нужно пропатчить модуль ALc.с. При возвращении из alcGetString() нужно делать поверку на NULL: return (value == NULL) ? &quot;&quot; : value;</p>
<h1 id="как-поставить-adb-драйвер-для-kindle-fire-phone">КАК ПОСТАВИТЬ ADB-ДРАЙВЕР ДЛЯ KINDLE FIRE PHONE</h1>
<p>Дравера качаются отсюда, а не из Android SDK Manager:
<a href="https://s3.amazonaws.com/android-sdk-manager/redist/Fire_Phone.zip">https://s3.amazonaws.com/android-sdk-manager/redist/Fire_Phone.zip</a></p>
<h1 id="как-залепить-проблему-jartoxml--unsupported-majorminor-version-510">КАК ЗАЛЕПИТЬ ПРОБЛЕМУ &quot;JARTOXML ... Unsupported major.minor version 51.0&quot;</h1>
<p>Нужно установить Jdk1.7
<a href="http://download.oracle.com/otn-pub/java/jdk/7u71-b14/jdk-7u71-windows-i586.exe">http://download.oracle.com/otn-pub/java/jdk/7u71-b14/jdk-7u71-windows-i586.exe</a>
Затем в Program Files(x86)/Java, переименовать jdk.1.6.0_39 во что-то непотребное</p>

</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          GameForest 2024
        </div>
      </div>
    </footer>
  </body>
</html>
