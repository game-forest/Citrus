<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Tangerine scene tree | Citrus Engine </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Tangerine scene tree | Citrus Engine ">
      
      <link rel="icon" href="../../images/favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../images/logo.png" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="tangerine-scene-tree">Tangerine scene tree</h1>

<h2 id="what-is-a-scene-tree-and-why-do-we-need-one">What is a scene tree and why do we need one?</h2>
<p>A scene tree is an object tree of class SceneItem, which is a hierarchy parallel to the node tree. But unlike the node hierarchy, it takes into account the placement of nodes within folders, the hierarchical organization of bones, etc. This significantly simplifies visualization of the scene structure, as well as its editing, hiding the whole mechanism of index recalculation for folders and bones behind the scene tree API. Visually, the scene tree can be seen as a timeline element, on the animations panel and on the scene hierarchy panel.</p>
<p>The reference to the root of the tree is in the document: Document.Current.SceneTree. The node of the tree is an object of the SceneItem class (currently Row, will be renamed to SceneItem in the future).</p>
<h2 id="how-to-modify-the-scene-tree">How to modify the scene tree</h2>
<ol>
<li><p>In order to properly add nodes, folders, animations, etc., you must use the <code>LinkSceneItem.Perform()</code> method.</p>
<p>You can never add nodes directly to a NodeList collection. This is because within itself a node has an additional folder hierarchy that is not directly created to the NodeList. And if you add a node to the NodeList using <code>AddIntoCollection.Perform()</code> the folder structure will be broken.</p>
</li>
<li><p>To build a scene tree for a new node (just created or cloned) execute the following code:</p>
<pre><code class="lang-csharp">var sceneItem = Document.Current.SceneTreeBuilder.BuildForNode(node); 
</code></pre>
<p>Then you can add it to the document's scene tree like this:</p>
<pre><code class="lang-csharp">LinkSceneItem.Perform(Document.Current.SceneItem, 0, sceneItem);
</code></pre>
<p>But as said in the previous paragraph, there is an overload <code>LinkSceneItem.Perform()</code> which takes a Node and internally calls <code>BuildForNode()</code>.</p>
</li>
<li><p>To translate a node, animation, property into an existing SceneItem you need to use the <code>Document.Current.GetSceneItemForObject()</code> method.</p>
</li>
<li><p>Bones are also added to nodes and parent bones using <code>LinkSceneItem.Perform()</code>. If the parent SceneItem is also a bone, the index passed to this method is the index of the binding of the bone to the parent bone.</p>
</li>
<li><p>If the current SceneItem refers to a node, its children (the <code>SceneItem.Items</code> collection) are arranged in the following order: animations, animated properties, child nodes. Accordingly, if the parent node has 1 animation and 2 animated properties, then calling</p>
<pre><code class="lang-csharp">LinkSceneItem.Perform(parentNodeItem, 0, childNodeItem);
</code></pre>
<p>will insert the childNodeItem not at the zero position, but at the third position in the parentNodeItem.Items list.</p>
</li>
</ol>

</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          GameForest 2024
        </div>
      </div>
    </footer>
  </body>
</html>
